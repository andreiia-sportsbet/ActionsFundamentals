name: _shared-template-blackbox-js-tests
# Shared Github workflow for js blackbox testing

on:
  workflow_call:
    inputs:
      env:
        description: Environment to test
        required: true
        default: tst
        type: string
      service_directory:
        description: The path of the service that contains blackbox tests in the mono repo
        required: true
        type: string

jobs:
  blackbox-test:
    name: Blackbox Test
    runs-on: ubuntu-latest
    env:
      ENV: ${{ inputs.env }}
      ENVIRONMENT: ${{ inputs.env }}

    steps:
      - name: Checkout
        uses: actions/checkout@v3

      - name: Running Tests
        run: make deployment-blackbox-tests

      - name: Upload Test Report
        if: success() || failure()
        uses: actions/upload-artifact@v3
        with:
          name: test-report
          path: /__w/cst-services/cst-services/${{ inputs.service_directory }}/blackbox-tests/test-report/index.html
